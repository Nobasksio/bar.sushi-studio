<template>
    <v-card flat class="my-map" >
        <div class="float-left address-card d-none d-md-block">
            <v-card>
                <v-list >
                    <v-list-item-group >
                        <v-list-item >
                            <v-list-item-icon >

                                <svg width="13" height="13" viewBox="0 0 13 13" fill="none"
                                     xmlns="http://www.w3.org/2000/svg" >
                                    <path d="M6.49996 0C3.6415 0 1.32373 2.31738 1.32373 5.17584C1.32373 9.4781 6.49996 13 6.49996 13C6.49996 13 11.6762 9.21902 11.6762 5.17545C11.6762 2.31699 9.35842 0 6.49996 0ZM6.49996 7.64276C5.13657 7.64276 4.03187 6.53807 4.03187 5.17545C4.03187 3.81284 5.13657 2.70814 6.49996 2.70814C7.86257 2.70775 8.96727 3.81322 8.96727 5.17584C8.96688 6.53845 7.86257 7.64276 6.49996 7.64276Z"
                                          fill="#BFBFBF" />
                                </svg >


                            </v-list-item-icon >
                            <v-list-item-content >
                                <v-list-item-title v-text="bar.adress" class="pr-4">

                                </v-list-item-title >
                            </v-list-item-content >
                        </v-list-item >
                        <v-divider ></v-divider >
                        <v-list-item @click="call(`+7 (3952)${ bar.phone }`)">
                            <v-list-item-icon >

                                <svg width="13" height="13" viewBox="0 0 13 13" fill="none"
                                     xmlns="http://www.w3.org/2000/svg" >

                                    <path d="M12.9726 10.0726C12.9358 9.96183 12.7018 9.79862 12.2709 9.58338C12.1542 9.51553 11.9878 9.42333 11.7726 9.30637C11.5571 9.1894 11.3616 9.08161 11.1863 8.98311C11.0106 8.88464 10.846 8.78924 10.6923 8.69704C10.6677 8.67858 10.5908 8.6248 10.4615 8.53535C10.3321 8.44616 10.223 8.37996 10.1336 8.33679C10.0444 8.29388 9.9566 8.27228 9.87042 8.27228C9.74734 8.27228 9.5936 8.36004 9.40901 8.53535C9.22443 8.71088 9.0551 8.90155 8.9013 9.10794C8.74747 9.31422 8.58432 9.50489 8.41215 9.68033C8.23972 9.85583 8.09804 9.9435 7.98738 9.9435C7.93183 9.9435 7.86256 9.92801 7.77954 9.89745C7.69656 9.86669 7.63344 9.84034 7.5901 9.81909C7.54716 9.79739 7.47346 9.75445 7.36875 9.68961C7.26384 9.62496 7.2055 9.58955 7.19321 9.58338C6.34999 9.11547 5.6268 8.57995 5.02353 7.97693C4.42045 7.37356 3.88486 6.65044 3.41708 5.80712C3.41094 5.7948 3.37546 5.73629 3.31088 5.63171C3.24621 5.52703 3.2031 5.45327 3.18156 5.41006C3.16002 5.36702 3.13386 5.3039 3.10314 5.22082C3.07242 5.13774 3.05699 5.06854 3.05699 5.01308C3.05699 4.90235 3.14473 4.76071 3.32016 4.58834C3.49557 4.41608 3.68643 4.2529 3.89256 4.09913C4.09884 3.94536 4.28951 3.77603 4.46498 3.59145C4.64038 3.40676 4.72809 3.25296 4.72809 3.12988C4.72809 3.04376 4.70655 2.95596 4.66351 2.86674C4.62043 2.77732 4.55427 2.66821 4.46498 2.53889C4.37566 2.40964 4.32182 2.33277 4.30332 2.30803C4.21109 2.15426 4.11579 1.98962 4.01719 1.81419C3.91859 1.63878 3.81097 1.44327 3.69397 1.22786C3.57706 1.01255 3.4848 0.846298 3.41702 0.729362C3.20171 0.298581 3.03863 0.0645799 2.9278 0.0277787C2.88469 0.00931348 2.82002 0 2.73393 0C2.56765 0 2.35072 0.0307215 2.08299 0.0923587C1.81516 0.153899 1.60441 0.218446 1.45052 0.28626C1.14275 0.415452 0.816553 0.790902 0.471825 1.41248C0.157915 1.99095 0.000976562 2.5635 0.000976562 3.12972C0.000976562 3.29578 0.0117453 3.45734 0.0332827 3.61444C0.0548201 3.77138 0.0933029 3.94837 0.148763 4.14537C0.204127 4.34231 0.248786 4.48861 0.282548 4.58388C0.316341 4.67921 0.379434 4.84999 0.471792 5.09628C0.564022 5.34251 0.619482 5.49324 0.637947 5.54864C0.853354 6.15188 1.1088 6.69041 1.40421 7.16439C1.89025 7.95222 2.55355 8.76641 3.3937 9.60663C4.23389 10.4468 5.04791 11.11 5.83581 11.5963C6.30973 11.8917 6.84845 12.1471 7.4516 12.3626C7.50703 12.381 7.65776 12.4363 7.90388 12.5289C8.15011 12.6212 8.32095 12.6843 8.41629 12.7181C8.51165 12.752 8.65798 12.7967 8.85476 12.8522C9.05196 12.9076 9.22879 12.9461 9.38573 12.9678C9.54276 12.9891 9.70436 13 9.87045 13C10.4366 13 11.0092 12.843 11.5878 12.5291C12.2093 12.1845 12.5847 11.8583 12.7139 11.5503C12.7819 11.3965 12.8463 11.1857 12.9078 10.9179C12.9695 10.6502 13.0002 10.4333 13.0002 10.267C13.0004 10.1806 12.9911 10.1161 12.9726 10.0726Z"
                                          fill="#BFBFBF" />
                                </svg >
                            </v-list-item-icon>
                            <v-list-item-content>
                                <v-list-item-title v-text="`+7 (3952)${bar.phone}`">

                                </v-list-item-title>

                            </v-list-item-content>

                        </v-list-item>
                        <v-divider ></v-divider>
                        <v-list-item>
                            <v-list-item-icon>

                                <svg width="13" height="13" viewBox="0 0 13 13" fill="none"
                                     xmlns="http://www.w3.org/2000/svg" >
                                    <path d="M6.5 0C2.9159 0 0 2.9159 0 6.5C0 10.0841 2.9159 13 6.5 13C10.0841 13 13 10.0841 13 6.5C13 2.9159 10.0841 0 6.5 0ZM6.5 11.6169C3.67856 11.6169 1.38296 9.32157 1.38296 6.5C1.38296 3.67843 3.67856 1.38309 6.5 1.38309C9.32144 1.38309 11.617 3.67843 11.617 6.5C11.617 9.32157 9.32144 11.6169 6.5 11.6169Z"
                                          fill="#BFBFBF" />
                                    <path d="M9.88751 6.29928H6.9664V2.78703C6.9664 2.49147 6.72676 2.25183 6.4312 2.25183C6.13563 2.25183 5.896 2.49147 5.896 2.78703V6.83448C5.896 7.13004 6.13563 7.36968 6.4312 7.36968H9.88751C10.1831 7.36968 10.4227 7.13004 10.4227 6.83448C10.4227 6.53891 10.1831 6.29928 9.88751 6.29928Z"
                                          fill="#BFBFBF" />
                                </svg >

                            </v-list-item-icon>
                            <v-list-item-content>
                                <v-list-item-title v-text="bar.open_time +'-'+ bar.close_time" ></v-list-item-title>
                            </v-list-item-content>
                        </v-list-item>
                    </v-list-item-group>
                </v-list>
            </v-card>
        </div>
        <yandex-map :settings="settings" class="yandex-map"
                    :controls="[]"
                    zoom="17"
                    :coords="[bar.coords.longitude,bar.coords.latitude]" >
            <ymap-marker
                    v-for="(item, index) in bars"
                    :key="index"
                    :marker-id="index"
                    hint-content="Hint content 1"
                    :icon="{color: 'red'}"
                    :balloon="{
                        header: 'Суши Бар на '+item.Name,
                        body: 'Режим работы:'+item.open_time+'-'+ item.close_time,
                        footer: 'телефон: '+item.phone
                    }"

                    :coords="[item.coords.longitude,item.coords.latitude]"

            ></ymap-marker >

        </yandex-map >
        <div class=" d-md-none d-block">
            <v-card>
                <v-list >
                    <v-list-item-group >
                        <v-list-item >
                            <v-list-item-icon >

                                <svg width="13" height="13" viewBox="0 0 13 13" fill="none"
                                     xmlns="http://www.w3.org/2000/svg" >
                                    <path d="M6.49996 0C3.6415 0 1.32373 2.31738 1.32373 5.17584C1.32373 9.4781 6.49996 13 6.49996 13C6.49996 13 11.6762 9.21902 11.6762 5.17545C11.6762 2.31699 9.35842 0 6.49996 0ZM6.49996 7.64276C5.13657 7.64276 4.03187 6.53807 4.03187 5.17545C4.03187 3.81284 5.13657 2.70814 6.49996 2.70814C7.86257 2.70775 8.96727 3.81322 8.96727 5.17584C8.96688 6.53845 7.86257 7.64276 6.49996 7.64276Z"
                                          fill="#BFBFBF" />
                                </svg >


                            </v-list-item-icon >
                            <v-list-item-content >
                                <v-list-item-title v-text="bar.adress" class="pr-4">

                                </v-list-item-title >
                            </v-list-item-content >
                        </v-list-item >
                        <v-divider ></v-divider >
                        <v-list-item @click="call('+7 (3952) '+bar.phone)">
                            <v-list-item-icon >

                                <svg width="13" height="13" viewBox="0 0 13 13" fill="none"
                                     xmlns="http://www.w3.org/2000/svg" >

                                    <path d="M12.9726 10.0726C12.9358 9.96183 12.7018 9.79862 12.2709 9.58338C12.1542 9.51553 11.9878 9.42333 11.7726 9.30637C11.5571 9.1894 11.3616 9.08161 11.1863 8.98311C11.0106 8.88464 10.846 8.78924 10.6923 8.69704C10.6677 8.67858 10.5908 8.6248 10.4615 8.53535C10.3321 8.44616 10.223 8.37996 10.1336 8.33679C10.0444 8.29388 9.9566 8.27228 9.87042 8.27228C9.74734 8.27228 9.5936 8.36004 9.40901 8.53535C9.22443 8.71088 9.0551 8.90155 8.9013 9.10794C8.74747 9.31422 8.58432 9.50489 8.41215 9.68033C8.23972 9.85583 8.09804 9.9435 7.98738 9.9435C7.93183 9.9435 7.86256 9.92801 7.77954 9.89745C7.69656 9.86669 7.63344 9.84034 7.5901 9.81909C7.54716 9.79739 7.47346 9.75445 7.36875 9.68961C7.26384 9.62496 7.2055 9.58955 7.19321 9.58338C6.34999 9.11547 5.6268 8.57995 5.02353 7.97693C4.42045 7.37356 3.88486 6.65044 3.41708 5.80712C3.41094 5.7948 3.37546 5.73629 3.31088 5.63171C3.24621 5.52703 3.2031 5.45327 3.18156 5.41006C3.16002 5.36702 3.13386 5.3039 3.10314 5.22082C3.07242 5.13774 3.05699 5.06854 3.05699 5.01308C3.05699 4.90235 3.14473 4.76071 3.32016 4.58834C3.49557 4.41608 3.68643 4.2529 3.89256 4.09913C4.09884 3.94536 4.28951 3.77603 4.46498 3.59145C4.64038 3.40676 4.72809 3.25296 4.72809 3.12988C4.72809 3.04376 4.70655 2.95596 4.66351 2.86674C4.62043 2.77732 4.55427 2.66821 4.46498 2.53889C4.37566 2.40964 4.32182 2.33277 4.30332 2.30803C4.21109 2.15426 4.11579 1.98962 4.01719 1.81419C3.91859 1.63878 3.81097 1.44327 3.69397 1.22786C3.57706 1.01255 3.4848 0.846298 3.41702 0.729362C3.20171 0.298581 3.03863 0.0645799 2.9278 0.0277787C2.88469 0.00931348 2.82002 0 2.73393 0C2.56765 0 2.35072 0.0307215 2.08299 0.0923587C1.81516 0.153899 1.60441 0.218446 1.45052 0.28626C1.14275 0.415452 0.816553 0.790902 0.471825 1.41248C0.157915 1.99095 0.000976562 2.5635 0.000976562 3.12972C0.000976562 3.29578 0.0117453 3.45734 0.0332827 3.61444C0.0548201 3.77138 0.0933029 3.94837 0.148763 4.14537C0.204127 4.34231 0.248786 4.48861 0.282548 4.58388C0.316341 4.67921 0.379434 4.84999 0.471792 5.09628C0.564022 5.34251 0.619482 5.49324 0.637947 5.54864C0.853354 6.15188 1.1088 6.69041 1.40421 7.16439C1.89025 7.95222 2.55355 8.76641 3.3937 9.60663C4.23389 10.4468 5.04791 11.11 5.83581 11.5963C6.30973 11.8917 6.84845 12.1471 7.4516 12.3626C7.50703 12.381 7.65776 12.4363 7.90388 12.5289C8.15011 12.6212 8.32095 12.6843 8.41629 12.7181C8.51165 12.752 8.65798 12.7967 8.85476 12.8522C9.05196 12.9076 9.22879 12.9461 9.38573 12.9678C9.54276 12.9891 9.70436 13 9.87045 13C10.4366 13 11.0092 12.843 11.5878 12.5291C12.2093 12.1845 12.5847 11.8583 12.7139 11.5503C12.7819 11.3965 12.8463 11.1857 12.9078 10.9179C12.9695 10.6502 13.0002 10.4333 13.0002 10.267C13.0004 10.1806 12.9911 10.1161 12.9726 10.0726Z"
                                          fill="#BFBFBF" />
                                </svg >
                            </v-list-item-icon >
                            <v-list-item-content >
                                <v-list-item-title >
                                    {{'+7 (3952) '+bar.phone}}
                                </v-list-item-title >

                            </v-list-item-content >

                        </v-list-item >
                        <v-divider ></v-divider >
                        <v-list-item >
                            <v-list-item-icon >

                                <svg width="13" height="13" viewBox="0 0 13 13" fill="none"
                                     xmlns="http://www.w3.org/2000/svg" >
                                    <path d="M6.5 0C2.9159 0 0 2.9159 0 6.5C0 10.0841 2.9159 13 6.5 13C10.0841 13 13 10.0841 13 6.5C13 2.9159 10.0841 0 6.5 0ZM6.5 11.6169C3.67856 11.6169 1.38296 9.32157 1.38296 6.5C1.38296 3.67843 3.67856 1.38309 6.5 1.38309C9.32144 1.38309 11.617 3.67843 11.617 6.5C11.617 9.32157 9.32144 11.6169 6.5 11.6169Z"
                                          fill="#BFBFBF" />
                                    <path d="M9.88751 6.29928H6.9664V2.78703C6.9664 2.49147 6.72676 2.25183 6.4312 2.25183C6.13563 2.25183 5.896 2.49147 5.896 2.78703V6.83448C5.896 7.13004 6.13563 7.36968 6.4312 7.36968H9.88751C10.1831 7.36968 10.4227 7.13004 10.4227 6.83448C10.4227 6.53891 10.1831 6.29928 9.88751 6.29928Z"
                                          fill="#BFBFBF" />
                                </svg >

                            </v-list-item-icon >
                            <v-list-item-content >
                                <v-list-item-title v-text="bar.open_time +'-'+ bar.close_time" >

                                </v-list-item-title >
                            </v-list-item-content >
                        </v-list-item >
                    </v-list-item-group >
                </v-list >
            </v-card >
        </div>
    </v-card >
</template>

<script>
    export default {
        name: "mapComponent",
        props: {
            bar: { type: Object, required: true },
            bars: { type: Array, required: true }
        },
        data: () => ({
            settings: {},
            windowSize: {
                x: 0,
                y: 0,
            },
        }),
        mounted () {
            this.onResize();
        },
        methods: {
            onResize () {
                this.windowSize = { x: window.innerWidth, y: window.innerHeight }
            },
            cleanPhone (dirty_phone) {
                return dirty_phone.replace(/\D/g,'')
            },
            call (phone) {
                document.location.href = 'tel:+' +this.cleanPhone(phone)
            }
        }
    }
</script>

<style scoped>
    .my-map {
        height: 450px;
        margin-bottom: 230px;
    }
    .address-card {
        position: relative;
        margin-bottom: -160px;
        margin-top: 20px;
        margin-left: 20px;
        z-index:10213012312312;
    }
    @media (min-width: 1000px) {
        .yandex-map {
            height: 100%;
        }

    }
    @media (max-width: 1000px) {
        .yandex-map {
            height: 75%;
        }

    }
</style>